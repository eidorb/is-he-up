<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Is he up?</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h2>Is he up?</h2>
          <h1 id="placeholder-state"></h1>
        </header>

        <p><img id="placeholder-image" class="circular" src="images/prolly-not.jpg"></p>
        <p id="placeholder-time"></p>

        <footer>
          Is-he-up is maintained by <a href="https://github.com/eidorb">eidorb</a><br>
        </footer>

      </div>
    </div>

    <script src="javascripts/moment.min.js"></script>
    <script src="javascripts/moment-timezone-with-data-2010-2020.min.js"></script>
    <script src="javascripts/jquery-1.11.1.min.js"></script>
    <script>
      var states = {
        'maybe': {
          'class': 'maybe',
          'text': 'Maybs!',
          'image': 'images/maybe.jpg'
        },
        'prolly-not': {
          'class': 'prolly-not',
          'text': 'Prolly not!',
          'image': 'images/prolly-not.jpg'
        },
        'yes': {
          'class': 'yes',
          'text': 'Yes!',
          'image': 'images/yes.jpg'
        }
      }
      function isHeUp(m) {
        m = moment.tz('Australia/Brisbane');
        var day = m.day();
        var hour = m.hour();
        // Monday to Thursday.
        if (day >= 1 && day <= 4) {
          if (hour >= 6 && hour <= 23) {
            if (hour >= 7 && hour < 22) {
              return states['yes'];
            };
            return states['maybe'];
          };
        // Friday.
        } else if (day == 5) {
          if (hour >= 6 && hour <= 22) {
            if (hour >= 7 && hour <= 23) {
              return states['yes'];
            };
            return states['maybe'];
          };
        // Saturday.
        } else if (day == 6) {
          if (hour >= 0 && hour <= 1) {
            return states['maybe']
          } else if (hour >= 2 && hour <= 6) {
            return states['prolly-not'];
          };
          return states['yes'];
        // Sunday.
        } else if (day == 0) {
          if (hour >= 2 && hour < 7) {
            return states['prolly-not'];
          } else if (hour >= 7 && hour < 22) {
            return states['yes'];
          };
          return states['maybe'];
        };
        return states['prolly-not'];
      }
    function updateState() {
      var hisMoment = moment.tz('Australia/Brisbane');
      var state = isHeUp(hisMoment);
      $('#placeholder-state').attr('class', state['class']);
      $('#placeholder-state').text(state.text);
      $('#placeholder-time').text(hisMoment.format("[It's] h:mm:ss A [on] dddd [where he is.]"));
      $('#placeholder-image').attr('src', state.image);
    };
    $(function(){
      updateState();
      setInterval(updateState, 1000);
    });
    </script>

  </body>
</html>
